\chapter{Design and Implementation}
\label{sec:design_implementation}

In this chapter we discuss the security model of \XMHF64. Then we discuss the \XMHF64 design, which achieves compatibility and security. Finally, we discuss implementation details of \XMHF64.

\input{C3_DesignImpl/1_security_model}

\section{Design}

\input{C3_DesignImpl/2_1_design_compatibility}
\input{C3_DesignImpl/2_2_design_nested_virt}
\input{C3_DesignImpl/2_3_design_verifiability}

\section{Implementation}

\input{C3_DesignImpl/3_1_64bit}
\input{C3_DesignImpl/3_2_impl_compatibility}
\input{C3_DesignImpl/3_3_impl_nested_virt}
\input{C3_DesignImpl/3_4_impl_nmi}
\input{C3_DesignImpl/3_5_performance}

